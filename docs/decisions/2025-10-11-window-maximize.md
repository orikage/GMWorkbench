# 2025-10-11: ウィンドウ最大化トグルの導入方針

## 背景
- 複数窓で参照していても、特定のシーンでは 1 つの PDF を全画面に近いサイズで確認したいケースがある。
- 現状は手動でリサイズする必要があり、復元する際も同じ操作を繰り返すためテンポを損なっていた。
- ドラッグ／リサイズイベントは常に有効なため、意図せず位置がずれてしまうリスクも残っていた。

## 目的
- ワンクリックで「全体表示 ↔ 元のレイアウト」を切り替え、必要なときだけ机いっぱいに広げられるようにする。
- 最大化中は余分な操作を受け付けず、視覚的にも「固定化」されていることが分かるようにする。
- 復元時には元の位置・サイズへ正確に戻し、永続化でもレイアウトを再現できるようにする。

## 選択肢
1. **最大化機能を用意しない**
   - 実装は不要だが、毎回手動でリサイズし直すコストが残り UX 改善につながらない。
2. **CSS の `transform: scale` で疑似的に拡大する**
   - 操作は軽いが、クリック判定やリサイズハンドルとの整合が崩れ、描画とメタデータがずれる。
3. **ウィンドウのジオメトリを保存して最大化／復元を切り替える** ← 採用
   - スタイルとデータが一致し、永続化や複製といった既存の仕組みとも整合が取れる。

## 決定
- ヘッダーに「最大化」ボタンを追加し、押下でキャンバス全面に広げ、再度押下で保存済みレイアウトへ戻す。
- 最大化中はヘッダードラッグとリサイズハンドルを無効化し、状態を `workspace__window--maximized` / `data-window-maximized` に反映する。
- `workspace:window-maximize-change` を定義し、現在のジオメトリと復元用レイアウト (`restore*`) を通知して外部連携に備える。
- 永続化スキーマへ `maximized` と `restoreLeft`/`restoreTop`/`restoreWidth`/`restoreHeight` を追加し、複製時は通常サイズで生成する。

## 影響
- ストレージレコードとテストモックを更新し、最大化状態と復元用ジオメトリを扱えるようにした。
- ヘッダーコントロール群とスタイルを調整し、最大化時はリサイズハンドルを非表示にした。
- `workspace:window-duplicate` のイベント詳細に `maximized` を追加し、複製後の同期を明確にした。
