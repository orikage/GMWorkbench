# 2025-10-12: PDF内検索とアウトライン導入の判断

## 背景
- ウィンドウ機能が充実している一方で、長編シナリオ内の目的ページへ辿り着く手段がページ番号の直接入力しかなく、探索性が低かった。
- 章立てのアウトラインやキーワード検索をアプリ内に統合して、外部ビューアへ切り替える頻度を抑えたいという要望があった。

## 決定
- キーボードショートカット `Ctrl/⌘+F` で検索フォームへフォーカスできるようにし、キーワード検索と結果リストのナビゲーションをウィンドウ内で完結させる。
- 検索結果を最大 200 件まで保持し、イベント (`workspace:window-search`) と `data-search-*` 属性で現在の検索状態を外部連携へ公開する。
- pdf.js のアウトライン API を利用して章構成を取得し、クリックでページ移動できるリストを表示するとともに、`workspace:window-outline-jump` で遷移を通知する。

## 影響
- ページ番号を覚えていない場合でも検索・アウトラインから素早く目的のページへ移動でき、参照時間を短縮できる。
- 検索・アウトライン状態が DOM 属性とイベントで公開されるため、後続の E2E テストや外部連携が容易になる。
- pdf.js のテキスト抽出を都度行うため長大な PDF では多少時間が掛かるが、結果件数を制限しつつ UI で処理中を表示することで混乱を避ける。

## フォローアップ
- 将来的に検索結果へハイライトを描画するか、ページ内スクロール位置を正確に合わせる改善余地がある。
- アウトラインが存在しない PDF 向けに、ユーザーが手動でセクションショートカットを登録できる仕組みの検討を継続する。
